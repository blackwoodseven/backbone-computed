
/*
 * -------------------------------------------------------
 * Project: Backbone Computed
 * Version: 0.0.1
 *
 * Author:  Blackwood Seven A/S
 * Site:     http://www.blackwoodseven.com
 * Contact: 
 *
 *
 * Copyright (c) 2014 Blackwood Seven A/S
 * -------------------------------------------------------
 */

!function(root,factory){"object"==typeof exports?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):root.BackboneComputed=factory()}(this,function(){var BackboneComputed={VERSION:"0.0.1"};return BackboneComputed.mixin={get:function(attr){var parent,computedAttr;if(!this.computed)return parent.apply(this,arguments);if(this.parent||(parent=Backbone.Model.prototype.get),attr in this.computed){if(computedAttr=this.computed[attr],_.isFunction(computedAttr))return computedAttr.apply(this);if(_.isObject(computedAttr)&&computedAttr.get)return computedAttr.get.apply(this)}return parent.apply(this,arguments)},set:function(attr,value,options){var parent,attrs;return this.computed?(this.parent||(parent=Backbone.Model.prototype.set),"object"==typeof attr?(attrs=attr,options=value):(attrs={})[attr]=value,options=options||{},_.each(attrs,function(value,attr){var computedAttr,currentValue;this._changing=!0,this._previousAttributes=_.clone(this.attributes),this.changed={},attr in this.computed?(computedAttr=this.computed[attr],_.isObject(computedAttr)&&computedAttr.set&&(computedAttr.set.call(this,value,options),currentValue=this.get(attr),_.isEqual(currentValue,value)||(this.changed[attr]=value,options.silent||this.trigger("change:"+attr,this,value,options)))):parent.call(this,attr,value,options)},this),options.silent||this.trigger("change",this,options),void(this._changing=!1)):parent.apply(this,arguments)}},BackboneComputed});